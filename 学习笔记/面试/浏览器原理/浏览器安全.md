# 浏览器安全

## 1.什么是XSS攻击

XSS是一种代码注入攻击，通过将一些非法脚本注入到目标网站，在用户的浏览器上运行，从而获取关于用户的一些私密信息，例如cookie、用户信息等，进而模拟用户操作，去执行一些操作。

XSS注入一般分为三种：

+   存储类XSS，通过将恶意脚本储存到数据库，等用户请求相关页面的时候，通过浏览器解析，执行恶意代码，从而达到XSS攻击。这是最危险的一种，因为只要注入到了数据库，每个用户访问这个网页都会被恶意代码，常见于论坛、评论等
+   反射类XSS，通过将恶意脚本注入到URL中，诱导用户点击带有恶意代码的URL，网站服务端解析URL并将其拼接在html中返回，进而实现XSS攻击，常见于网站搜索
+   DOM类XSS，通过将恶意脚本注入到URL中，诱导用户点击带有恶意代码的URL，用户浏览器收到响应后解析执行，前端Js取出URL中的恶意代码并执行，从而达到XSS攻击
+   前两种属于服务端的安全漏洞，DOM类XSS属于前端JS自身漏洞依靠的是浏览器端的DOM解析

## 2.预防XSS攻击

+   对输入框进行输入格式校验，同时为了避免攻击者绕开前端的校验，直接向服务端发起请求，所以服务端也要做好相应的格式校验
+   转义HTML
+   配置白名单
+   设置httponly，在 cookie 中设置 HttpOnly 属性后，js脚本将无法读取到 cookie 信息。
+   改成纯前端渲染一个无关业务数据的静态的HTML，再通过Ajax请求加载业务数据
+   降低使用innerHTML、eval等影响安全性的API

## 3.什么是CSRF攻击

CSRF是一种跨站请求伪造攻击，通过受害者在被攻击网站取得的注册凭证，绕过后台的验证，达到冒充用户去对被攻击网站执行某项操作的功能，攻击一般发起在第三方网站，利用 cookie 会在同源请求中携带发送给服务器的特点，以此来实现用户的冒充。

常见的CSRF攻击：

+   GET类型，通常只需要一个http请求，比如将该请求注入到图片中，用户在访问含有这个图片的页面后，就会发起请求，被攻击的网站就会收到包含受害者信息的一条跨域请求
+   POST类型，通常为一个表单，访问该网页后，表单会自动提交
+   链接类型，点击链接就会触发

## 4.预防CSRF攻击

+   配置验证码，让用户与页面进行交互才能够完成一些请求
+   同源检测，对请求的来源进行限制，但低版本的浏览器可以伪造Referer
+   使用 CSRF Token 进行验证，服务器向用户返回一个随机数 Token ，当网站再次发起请求时，在请求参数中加入服务器端返回的 token ，然后服务器对这个 token 进行验证。
+   在设置 cookie 属性的时候设置 Samesite ，限制 cookie 不能作为被第三方使用
+   **对 Cookie 进行双重验证**，服务器在用户访问网站页面时，向请求域名注入一个Cookie，内容为随机字符串，然后当用户再次向服务器发送请求的时候，从 cookie 中取出这个字符串，添加到 URL 参数中，然后服务器通过对 cookie 中的数据和参数中的数据进行比较，来进行验证。
